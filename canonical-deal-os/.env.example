KERNEL_API_URL=http://localhost:3001
BFF_PORT=8787
DEMO_ACTOR_ID=
BFF_LIST_TTL_MS=5000
BFF_HOME_TTL_MS=3000
BFF_SNAPSHOT_TTL_MS=5000
BFF_LIST_CONCURRENCY=4
BFF_INBOX_TTL_MS=5000
BFF_INBOX_CONCURRENCY=4
BFF_ACTION_IDEMPOTENCY_TTL_MS=60000
BFF_DB_URL=file:./server/.data/llm-airlock.db
BFF_BASE44_APP_ID=
BFF_BASE44_TOKEN=
BFF_BASE44_FUNCTIONS_VERSION=
BFF_BASE44_APP_BASE_URL=
BFF_OPENAI_API_KEY=
BFF_OPENAI_MODEL=gpt-4o-mini
BFF_OPENAI_BASE_URL=https://api.openai.com/v1
BFF_OPENAI_ORG=
BFF_OPENAI_PROJECT=
BFF_OPENAI_TEMPERATURE=0
BFF_PUBLIC_URL=http://localhost:8787
BFF_LP_INVITATION_BASE_URL=http://localhost:8787
BFF_LP_PORTAL_TTL_MS=5000
BFF_LP_INVITATION_EXPIRY_DAYS=30

# Email Configuration (LP Invitations)
# Set BFF_LP_INVITATION_EMAIL_ENDPOINT to enable email notifications
# Leave empty for development logging mode
BFF_LP_INVITATION_EMAIL_ENDPOINT=
BFF_LP_INVITATION_EMAIL_API_KEY=
BFF_LP_INVITATION_EMAIL_FROM=Canonical LP Portal <noreply@canonical.com>

# Webhook Configuration (LP Events)
# Set BFF_LP_NOTIFICATION_WEBHOOK_URL to enable webhook notifications
# Webhooks fire on: LP_INVITATION_SENT, LP_INVITATION_ACCEPTED, LP_CAPITAL_EVENT, LP_BULK_IMPORT_*
BFF_LP_NOTIFICATION_WEBHOOK_URL=
BFF_LP_NOTIFICATION_WEBHOOK_SECRET=
BFF_LP_NOTIFICATION_WEBHOOK_HEADER=X-LP-Webhook-Secret

# JWT Authentication (REQUIRED - P1 Security)
# =============================================================================
# CRITICAL SECURITY REQUIREMENT:
# - JWT_SECRET must be at least 64 bytes (512-bit) for production security
# - Do NOT use default values in production
# - Do NOT commit real secrets to version control
#
# Generate a secure secret with:
#   node -e "console.log(require('crypto').randomBytes(64).toString('base64'))"
#
# The server will REFUSE TO START if:
# - JWT_SECRET is missing or empty
# - JWT_SECRET is less than 64 bytes
# - JWT_SECRET is a known weak/default value
# =============================================================================
JWT_SECRET=

# Redis Configuration (Rate Limiting + Caching)
# =============================================================================
# Required for rate limiting and distributed caching
# For local development, use: redis://localhost:6379
# For Docker, use: redis://redis:6379
# =============================================================================
REDIS_URL=redis://localhost:6379
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_ATTEMPTS=5

# DD Email Intake Configuration
# Email address format: deal-{dealId}@DD_EMAIL_DOMAIN
DD_EMAIL_INTAKE_ENABLED=false
DD_EMAIL_DOMAIN=docs.canonical.com
SENDGRID_INBOUND_SECRET=
DD_EMAIL_RATE_LIMIT=20
DD_MAX_ATTACHMENT_MB=25
DD_MAX_TOTAL_MB=50

# DD Assistant Configuration
DD_ASSISTANT_ENABLED=true
DD_AUTO_MATCH_DOCS=true
DD_ASSISTANT_MODEL=gpt-4o-mini
DD_CRITICAL_REQUIRED_PCT=100
DD_HIGH_REQUIRED_PCT=90

# Debug Logging
DEBUG_DD_EMAIL=false
DEBUG_DD_ASSISTANT=false
DEBUG_DD_SYNC=false

# Security Headers (Sprint 1)
# =============================================================================
# CORS Configuration
# Comma-separated list of allowed origins for CORS
# Default: localhost origins for development
CORS_ALLOWED_ORIGINS=http://localhost:5173,http://localhost:8787,http://localhost:3000

# Debug flags for security middleware
DEBUG_SECURITY_HEADERS=false
DEBUG_CORS=false

# Observability (Sprint 2)
# =============================================================================
# Sentry Error Tracking
# Get your DSN from https://sentry.io - leave empty to disable
SENTRY_DSN=
APP_VERSION=1.0.0

# Structured Logging
# Log levels: debug, info, warn, error
LOG_LEVEL=info
# Optional: Log to file (in addition to console)
# LOG_FILE=/var/log/cre-bff/app.log
# LOG_ERROR_FILE=/var/log/cre-bff/error.log

# Debug flags for observability
DEBUG_SENTRY=false
DEBUG_METRICS=false
DEBUG_LOGGER=false
# =============================================================================

# Frontend Demo Mode (Vite only)
# =============================================================================
# For LOCAL DEVELOPMENT ONLY: Set VITE_DEMO_MODE=true to auto-authenticate
# as a demo user (GP role) without requiring real login credentials.
#
# To enable demo mode for development:
#   1. Create a file named .env.local in this directory
#   2. Add: VITE_DEMO_MODE=true
#
# IMPORTANT:
#   - .env.local is ignored by git and won't be committed
#   - Never enable demo mode in production or test environments
#   - Tests must exercise real authentication flows
# =============================================================================
# VITE_DEMO_MODE=false
